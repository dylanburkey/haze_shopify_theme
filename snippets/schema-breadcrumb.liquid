{%- comment -%}
  Breadcrumb Schema (JSON-LD)
  Outputs BreadcrumbList structured data for navigation
  Usage: {% render 'schema-breadcrumb' %}
{%- endcomment -%}

{%- liquid
  assign breadcrumbs = ''
  assign position = 1

  case template.name
    when 'product'
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"Home","item":"' | append: shop.url | append: '"},'
      assign position = position | plus: 1
      
      if product.collections.size > 0
        assign collection = product.collections.first
        assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"' | append: collection.title | append: '","item":"' | append: collection.url | prepend: shop.url | append: '"},'
        assign position = position | plus: 1
      endif
      
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"' | append: product.title | append: '","item":"' | append: product.url | prepend: shop.url | append: '"}'
      
    when 'collection'
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"Home","item":"' | append: shop.url | append: '"},'
      assign position = position | plus: 1
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"' | append: collection.title | append: '","item":"' | append: collection.url | prepend: shop.url | append: '"}'
      
    when 'article'
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"Home","item":"' | append: shop.url | append: '"},'
      assign position = position | plus: 1
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"' | append: blog.title | append: '","item":"' | append: blog.url | prepend: shop.url | append: '"},'
      assign position = position | plus: 1
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"' | append: article.title | append: '","item":"' | append: article.url | prepend: shop.url | append: '"}'
      
    when 'page'
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"Home","item":"' | append: shop.url | append: '"},'
      assign position = position | plus: 1
      assign breadcrumbs = breadcrumbs | append: '{"@type":"ListItem","position":' | append: position | append: ',"name":"' | append: page.title | append: '","item":"' | append: page.url | prepend: shop.url | append: '"}'
  endcase
-%}

{%- if breadcrumbs != blank -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {{ breadcrumbs }}
  ]
}
</script>
{%- endif -%}