{% comment %}
  Feature Cost Savings Section
  Displays app replacement savings calculator
{% endcomment %}

<section class="feature-cost-savings" data-section-id="{{ section.id }}">
  <div class="container">
    <div class="section-header section-header--center">
      {%- if section.settings.title != blank -%}
        <h2 class="section-title">{{ section.settings.title }}</h2>
      {%- endif -%}
      {%- if section.settings.subtitle != blank -%}
        <p class="section-subtitle">{{ section.settings.subtitle }}</p>
      {%- endif -%}
    </div>

    <div class="cost-savings__grid">
      {%- assign total_monthly = 0 -%}
      {%- for block in section.blocks -%}
        {%- if block.type == 'app_replacement' -%}
          {%- assign total_monthly = total_monthly | plus: block.settings.monthly_cost -%}
          <div class="cost-savings__card" {{ block.shopify_attributes }}>
            <div class="cost-savings__icon">
              {%- case block.settings.icon -%}
                {%- when 'menu' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
                {%- when 'award' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
                {%- when 'search' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                {%- when 'zap' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                {%- when 'layout' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
                {%- when 'help-circle' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                {%- when 'smartphone' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg>
                {%- when 'message-circle' -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>
                {%- else -%}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
              {%- endcase -%}
            </div>
            <div class="cost-savings__content">
              <div class="cost-savings__app-name">
                <span class="cost-savings__strikethrough">{{ block.settings.app_name }}</span>
                <span class="cost-savings__cost">${{ block.settings.monthly_cost }}/mo</span>
              </div>
              <div class="cost-savings__feature">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                {{ block.settings.feature_name }}
              </div>
            </div>
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>

    {%- if section.settings.show_calculator -%}
      <div class="cost-savings__total">
        <div class="cost-savings__total-inner">
          <div class="cost-savings__total-label">
            <span class="cost-savings__total-title">Total Monthly Savings</span>
            <span class="cost-savings__total-note">Apps you no longer need</span>
          </div>
          <div class="cost-savings__total-amounts">
            <div class="cost-savings__amount cost-savings__amount--monthly">
              <span class="cost-savings__amount-value">${{ total_monthly }}</span>
              <span class="cost-savings__amount-period">/month</span>
            </div>
            <div class="cost-savings__amount cost-savings__amount--yearly">
              <span class="cost-savings__amount-value">${{ total_monthly | times: 12 }}</span>
              <span class="cost-savings__amount-period">/year</span>
            </div>
          </div>
        </div>
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  .feature-cost-savings {
    padding: 5rem 0;
    background: var(--color-background-alt, #f8f9fa);
  }

  .cost-savings__grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
    margin-top: 3rem;
  }

  .cost-savings__card {
    background: var(--color-background, #ffffff);
    padding: 1.5rem;
    border-radius: var(--card-radius, 8px);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .cost-savings__card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .cost-savings__icon {
    width: 2.5rem;
    height: 2.5rem;
    margin-bottom: 1rem;
    color: var(--color-primary, #d71920);
  }

  .cost-savings__icon svg {
    width: 100%;
    height: 100%;
  }

  .cost-savings__app-name {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 0.5rem;
  }

  .cost-savings__strikethrough {
    text-decoration: line-through;
    color: var(--color-text-secondary, #666);
    font-size: 0.875rem;
  }

  .cost-savings__cost {
    color: #dc2626;
    font-weight: 600;
    font-size: 0.875rem;
  }

  .cost-savings__feature {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--color-text, #1a1a1a);
    font-weight: 600;
  }

  .cost-savings__feature svg {
    width: 1.25rem;
    height: 1.25rem;
    color: #16a34a;
    flex-shrink: 0;
  }

  .cost-savings__total {
    margin-top: 3rem;
    padding: 2rem;
    background: linear-gradient(135deg, var(--color-primary, #d71920) 0%, #b81419 100%);
    border-radius: var(--card-radius, 8px);
    color: #ffffff;
  }

  .cost-savings__total-inner {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 2rem;
  }

  .cost-savings__total-title {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
  }

  .cost-savings__total-note {
    display: block;
    opacity: 0.9;
    font-size: 0.875rem;
  }

  .cost-savings__total-amounts {
    display: flex;
    gap: 3rem;
  }

  .cost-savings__amount {
    text-align: right;
  }

  .cost-savings__amount-value {
    display: block;
    font-size: 2.5rem;
    font-weight: 800;
    line-height: 1;
  }

  .cost-savings__amount-period {
    font-size: 0.875rem;
    opacity: 0.9;
  }

  @media (max-width: 1024px) {
    .cost-savings__grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 640px) {
    .cost-savings__grid {
      grid-template-columns: 1fr;
    }

    .cost-savings__total-inner {
      flex-direction: column;
      text-align: center;
    }

    .cost-savings__total-amounts {
      justify-content: center;
    }
  }
</style>

{% schema %}
{
  "name": "Cost Savings Calculator",
  "tag": "section",
  "class": "section-cost-savings",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Your Monthly Savings"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Apps you no longer need"
    },
    {
      "type": "checkbox",
      "id": "show_calculator",
      "label": "Show savings total",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "app_replacement",
      "name": "App Replacement",
      "settings": [
        {
          "type": "text",
          "id": "app_name",
          "label": "App name being replaced",
          "default": "App Name"
        },
        {
          "type": "number",
          "id": "monthly_cost",
          "label": "Monthly cost ($)",
          "default": 20
        },
        {
          "type": "text",
          "id": "feature_name",
          "label": "FORGE feature name",
          "default": "Built-in Feature"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "menu", "label": "Menu" },
            { "value": "award", "label": "Award" },
            { "value": "search", "label": "Search" },
            { "value": "zap", "label": "Zap/Speed" },
            { "value": "layout", "label": "Layout" },
            { "value": "help-circle", "label": "Help/FAQ" },
            { "value": "smartphone", "label": "Smartphone" },
            { "value": "message-circle", "label": "Chat" },
            { "value": "check", "label": "Checkmark" }
          ],
          "default": "check"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Cost Savings Calculator"
    }
  ]
}
{% endschema %}
